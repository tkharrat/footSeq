---

title: Model


keywords: fastai
sidebar: home_sidebar



nb_path: "02_learner.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_learner.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.debugger</span> <span class="kn">import</span> <span class="n">set_trace</span>
<span class="kn">from</span> <span class="nn">IPython.utils</span> <span class="kn">import</span> <span class="n">traitlets</span> <span class="k">as</span> <span class="n">_traitlets</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/tmp/ipykernel_3321999/2943078347.py:2: UserWarning: IPython.utils.traitlets has moved to a top-level traitlets package.
  from IPython.utils import traitlets as _traitlets
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1><center> Learner </center></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this module, we define the model architecture that we will use in our learner. It will be based on <code>tsai</code> models with a simple tweak: ability to handle categorical features.</p>
<p>The strategy to build our model is fairly simple:</p>
<ul>
<li>apply a specific 'Embedding` layer to each categorical feature</li>
<li>concatenate the outcome of the embedding layers with the continuous features</li>
<li>pass the resulting tensor to a <code>tsai</code> existing model
The first 2 steps can be handled by the <em>head</em> of the network which can be seen as a layer.</li>
</ul>
<p>Once the architecture defined, we can define our learner in the usual way and benefit from <code>fastai</code> training loop.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;./data&quot;</span>
<span class="n">target_data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s2">&quot;targets.pkl&quot;</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
<span class="n">df_main</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s2">&quot;sequences_df.pkl&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_ids</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_main</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">target_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">target_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lbl2ids</span> <span class="o">=</span> <span class="p">{</span><span class="n">l</span><span class="p">:</span> <span class="n">L</span><span class="p">(</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">target_data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">}</span>
<span class="n">ids2size</span> <span class="o">=</span> <span class="n">df_main</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to test our different examples, let's prepare a batch of data:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;type_name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bodypart_name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;play_pattern_name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;is_home&quot;</span><span class="p">,</span>
    <span class="s2">&quot;under_pressure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;counterpress&quot;</span><span class="p">,</span>
    <span class="s2">&quot;is_poss_team&quot;</span><span class="p">,</span>
    <span class="s2">&quot;result_name&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;start_x&quot;</span><span class="p">,</span>
    <span class="s2">&quot;start_y&quot;</span><span class="p">,</span>
    <span class="s2">&quot;end_x&quot;</span><span class="p">,</span>
    <span class="s2">&quot;end_y&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time_seconds&quot;</span><span class="p">,</span>
    <span class="s2">&quot;seconds_since_poss&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1">## splits</span>
<span class="n">splits_ids</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">()(</span><span class="n">seq_ids</span><span class="p">)</span>

<span class="c1">## fitst transform inspired from tabular pandas</span>
<span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">]</span>
<span class="n">foot_tfm</span> <span class="o">=</span> <span class="n">FootSeqTransform</span><span class="p">(</span>
    <span class="n">sequence_df</span><span class="o">=</span><span class="n">df_main</span><span class="p">,</span>
    <span class="n">target_dict</span><span class="o">=</span><span class="n">target_data</span><span class="p">,</span>
    <span class="n">ids</span><span class="o">=</span><span class="n">seq_ids</span><span class="p">,</span>
    <span class="n">splits</span><span class="o">=</span><span class="n">splits_ids</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">procs</span><span class="o">=</span><span class="n">procs</span><span class="p">,</span>
    <span class="n">cat_names</span><span class="o">=</span><span class="n">cat_names</span><span class="p">,</span>
    <span class="n">cont_names</span><span class="o">=</span><span class="n">cont_names</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">## to-tensor transform</span>
<span class="n">to_tsr</span> <span class="o">=</span> <span class="n">FootSeqToTensor</span><span class="p">(</span><span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1">## tfmdlist</span>
<span class="n">tls</span> <span class="o">=</span> <span class="n">TfmdLists</span><span class="p">(</span><span class="n">seq_ids</span><span class="p">,</span> <span class="p">[</span><span class="n">foot_tfm</span><span class="p">,</span> <span class="n">to_tsr</span><span class="p">],</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits_ids</span><span class="p">)</span>

<span class="c1">## datalodaers</span>
<span class="n">train_seq_lens</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">ids2size</span><span class="p">[</span><span class="n">_id</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">_id</span> <span class="ow">in</span> <span class="n">seq_ids</span><span class="p">[</span><span class="n">splits_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">valid_seq_lens</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">ids2size</span><span class="p">[</span><span class="n">_id</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">_id</span> <span class="ow">in</span> <span class="n">seq_ids</span><span class="p">[</span><span class="n">splits_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>


<span class="c1">## pass the training dataset sequence lengths to SortedDL</span>
<span class="n">srtd_dl</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">SortedDL</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="n">train_seq_lens</span><span class="p">)</span>

<span class="c1">## Pass the validation dataset seq lengths</span>
<span class="n">dl_kwargs</span> <span class="o">=</span> <span class="p">[{},</span> <span class="p">{</span><span class="s2">&quot;val_res&quot;</span><span class="p">:</span> <span class="n">valid_seq_lens</span><span class="p">}]</span>

<span class="c1">## re-initialise dataloaders</span>
<span class="n">srtd_dls</span> <span class="o">=</span> <span class="n">tls</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span>
    <span class="n">bs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">before_batch</span><span class="o">=</span><span class="n">pad_seq</span><span class="p">,</span> <span class="n">dl_type</span><span class="o">=</span><span class="n">srtd_dl</span><span class="p">,</span> <span class="n">dl_kwargs</span><span class="o">=</span><span class="n">dl_kwargs</span>
<span class="p">)</span>

<span class="c1">##sample a batch</span>
<span class="n">srtd_batch</span> <span class="o">=</span> <span class="n">srtd_dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>

<span class="n">srtd_batch</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[[ 6,  1,  3,  1,  1,  1,  2,  5],
          [15,  1,  3,  1,  1,  1,  2,  5],
          [ 6,  1,  3,  1,  1,  1,  2,  5],
          [15,  1,  3,  1,  1,  1,  2,  5],
          [ 6,  1,  3,  1,  1,  1,  2,  5],
          [15,  1,  3,  1,  1,  1,  2,  5],
          [ 6,  1,  3,  1,  1,  1,  2,  5],
          [15,  1,  3,  1,  1,  1,  2,  5],
          [ 6,  1,  3,  1,  1,  1,  2,  5],
          [15,  1,  3,  1,  1,  1,  2,  5]],
 
         [[15,  1,  6,  1,  1,  1,  2,  5],
          [15,  1,  6,  1,  1,  1,  2,  5],
          [15,  1,  6,  1,  1,  1,  2,  5],
          [ 6,  1,  6,  1,  1,  1,  2,  5],
          [15,  3,  6,  1,  1,  1,  2,  5],
          [ 6,  1,  6,  1,  2,  1,  2,  5],
          [15,  1,  6,  1,  2,  1,  2,  5],
          [ 6,  1,  6,  1,  2,  1,  2,  5],
          [15,  1,  6,  1,  2,  1,  2,  5],
          [15,  1,  6,  1,  1,  1,  2,  5]],
 
         [[15,  1,  7,  1,  1,  1,  2,  5],
          [ 6,  1,  7,  1,  1,  1,  2,  5],
          [15,  1,  7,  1,  1,  1,  2,  5],
          [ 6,  1,  7,  1,  1,  1,  2,  5],
          [15,  1,  7,  1,  1,  1,  2,  5],
          [ 6,  1,  7,  1,  1,  1,  2,  5],
          [15,  1,  7,  1,  1,  1,  2,  5],
          [ 6,  1,  7,  1,  1,  1,  2,  5],
          [15,  1,  7,  1,  1,  1,  2,  5],
          [ 6,  1,  7,  1,  1,  1,  2,  5]]], device=&#39;cuda:0&#39;),
 tensor([[[-0.5608,  0.6991, -0.5657,  0.7094, -1.2093, -0.0855],
          [-0.5533,  0.6991, -0.4965,  1.2346, -1.2069,  0.0494],
          [-0.4854,  1.2167, -0.4965,  1.2346, -1.2057,  0.1168],
          [-0.4854,  1.2167, -0.8078,  1.6296, -1.2057,  0.1168],
          [-0.7909,  1.6059, -0.8078,  1.6296, -1.2045,  0.1843],
          [-0.7909,  1.6059, -0.3736,  1.3603, -1.2045,  0.1843],
          [-0.3647,  1.3405, -0.6041,  1.3603, -1.2021,  0.3192],
          [-0.5910,  1.3405, -0.2660,  0.8710, -1.1997,  0.4541],
          [-0.2591,  0.8583, -0.1699,  0.6690, -1.1997,  0.4541],
          [-0.1649,  0.6593, -0.7886,  0.4087, -1.1972,  0.5890]],
 
         [[-0.0593,  0.0267,  0.0184, -0.0626, -0.6654, -0.8274],
          [ 0.0199, -0.1459,  0.3258, -1.5035, -0.6642, -0.7600],
          [ 0.2651, -1.4995, -0.1930, -1.6067, -0.6617, -0.6251],
          [-0.1875, -1.5836, -0.1930, -1.6067, -0.6605, -0.5576],
          [-0.1875, -1.5836, -0.7310, -1.3554, -0.6605, -0.5576],
          [-0.7155, -1.3359, -0.7579, -1.3644, -0.6593, -0.4902],
          [-0.7419, -1.3447, -0.4351, -1.4586, -0.6593, -0.4902],
          [-0.4251, -1.4376, -0.3544, -1.0412, -0.6569, -0.3553],
          [-0.3459, -1.0262,  0.0607, -0.3050, -0.6557, -0.2878],
          [ 0.0614, -0.3007, -0.9116,  1.1942, -0.6521, -0.0855]],
 
         [[ 0.2236,  0.5885,  0.7908,  1.7912,  1.5383, -0.0180],
          [ 0.7780,  1.7652,  0.7831,  1.8092,  1.5395,  0.0494],
          [ 0.7704,  1.7829,  1.2750,  1.0955,  1.5407,  0.1168],
          [ 1.2532,  1.0795,  1.3173,  1.1763,  1.5431,  0.2517],
          [ 1.2946,  1.1591,  0.9676,  0.6780,  1.5443,  0.3192],
          [ 0.9515,  0.6681,  0.9292,  0.6735,  1.5467,  0.4541],
          [ 0.9137,  0.6637,  0.4219,  0.7723,  1.5479,  0.5215],
          [ 0.4159,  0.7610,  0.4373,  0.8037,  1.5491,  0.5890],
          [ 0.4310,  0.7920,  0.9100,  1.2077,  1.5515,  0.7239],
          [ 0.8949,  1.1901,  0.6679,  1.2840,  1.5540,  0.8588]]],
        device=&#39;cuda:0&#39;),
 TensorCategory([1, 1, 1], device=&#39;cuda:0&#39;))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Embedding">Embedding<a class="anchor-link" href="#Embedding"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Embedding" class="doc_header"><code>class</code> <code>Embedding</code><a href="https://github.com/fastai/fastai/tree/master/fastai/layers.py#L287" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Embedding</code>(<strong><code>ni</code></strong>, <strong><code>nf</code></strong>, <strong><code>std</code></strong>=<em><code>0.01</code></em>) :: <a href="/footSeq/learner.html#Embedding"><code>Embedding</code></a></p>
</blockquote>
<p>Embedding layer with truncated normal initialization</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiEmbedding" class="doc_header"><code>class</code> <code>MultiEmbedding</code><a href="https://github.com/tkharrat/footSeq/tree/master/footSeq/model/learner.py#L49" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiEmbedding</code>(<strong><code>n_embeds</code></strong>:<code>List</code>[<code>int</code>], <strong><code>embed_dims</code></strong>:<code>List</code>[<code>int</code>]=<em><code>None</code></em>, <strong><code>n_cont</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>std</code></strong>:<code>float</code>=<em><code>0.01</code></em>, <strong>**<code>kwargs</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Muti-dimesnion Embedding layer</p>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>cat_embed: torch.nn.ModuleList
    list of Embedding modules in the order in which categorical data appear</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to test this layer, we need to find the vocabulary size of each categorical variable and pass it in <code>n_embeds</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_embeds</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">tls</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">tls</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="n">cat_names</span><span class="p">]</span>
<span class="p">(</span><span class="n">tls</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="n">cat_names</span><span class="p">,</span> <span class="n">n_embeds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#8) [&#39;type_name&#39;,&#39;bodypart_name&#39;,&#39;play_pattern_name&#39;,&#39;is_home&#39;,&#39;under_pressure&#39;,&#39;counterpress&#39;,&#39;is_poss_team&#39;,&#39;result_name&#39;],
 [22, 4, 10, 3, 3, 3, 3, 7])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's initialize the layer and check that it works as expected:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_cont</span> <span class="o">=</span> <span class="n">srtd_batch</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">multi_em</span> <span class="o">=</span> <span class="n">MultiEmbedding</span><span class="p">(</span><span class="n">n_embeds</span><span class="o">=</span><span class="n">n_embeds</span><span class="p">,</span> <span class="n">n_cont</span><span class="o">=</span><span class="n">n_cont</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">tsr_em</span> <span class="o">=</span> <span class="n">multi_em</span><span class="p">(</span><span class="n">srtd_batch</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">srtd_batch</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span>
    <span class="n">tsr_em</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">L</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">multi_em</span><span class="o">.</span><span class="n">cat_embed</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">n_cont</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's investigate how we can use the <code>padding_idx</code> option. This can be very useful to avoid training useless weight corresponding to padding values. Let's first create a batch with some padded values:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reg_dls</span> <span class="o">=</span> <span class="n">tls</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">before_batch</span><span class="o">=</span><span class="n">pad_seq</span><span class="p">)</span>
<span class="n">padded_batch</span> <span class="o">=</span> <span class="n">reg_dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">padded_batch</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 6,  1,  9,  2,  1,  1,  2,  5],
        [15,  1,  9,  2,  1,  1,  2,  5],
        [ 6,  1,  9,  2,  1,  1,  2,  5],
        [15,  1,  9,  2,  1,  1,  2,  5],
        [ 6,  1,  9,  2,  1,  1,  2,  5],
        [15,  1,  9,  2,  1,  1,  2,  5],
        [ 6,  1,  9,  2,  1,  1,  2,  5],
        [15,  1,  9,  2,  1,  1,  2,  5],
        [ 6,  1,  9,  2,  1,  1,  2,  5],
        [15,  1,  9,  2,  1,  1,  2,  5]], device=&#39;cuda:0&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">multi_em_pad</span> <span class="o">=</span> <span class="n">MultiEmbedding</span><span class="p">(</span><span class="n">n_embeds</span><span class="p">,</span> <span class="n">padding_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_cont</span><span class="o">=</span><span class="n">n_cont</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">tsr_em</span> <span class="o">=</span> <span class="n">multi_em_pad</span><span class="p">(</span><span class="n">padded_batch</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">padded_batch</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">tsr_em</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-0.5199, -1.4598,  1.4809, -0.5296, -1.4100,  2.5280,  0.5804, -0.9284,
          0.9980, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459,  0.0501,  1.6502,  0.0491,  1.6745, -0.2641,
         -0.3553],
        [-0.1981,  1.0633,  0.9373, -1.5942,  0.1827, -0.7031,  0.0292, -0.7047,
          0.1495, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459,  0.0501,  1.6502, -0.1199,  1.1134, -0.2628,
         -0.2878],
        [-0.5199, -1.4598,  1.4809, -0.5296, -1.4100,  2.5280,  0.5804, -0.9284,
          0.9980, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459, -0.1158,  1.0972,  0.0338,  0.8306, -0.2616,
         -0.2204],
        [-0.1981,  1.0633,  0.9373, -1.5942,  0.1827, -0.7031,  0.0292, -0.7047,
          0.1495, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459,  0.0350,  0.8185,  0.3796, -1.5843, -0.2592,
         -0.0855],
        [-0.5199, -1.4598,  1.4809, -0.5296, -1.4100,  2.5280,  0.5804, -0.9284,
          0.9980, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459,  0.3744, -1.5615,  0.3412, -0.9020, -0.2556,
          0.1168],
        [-0.1981,  1.0633,  0.9373, -1.5942,  0.1827, -0.7031,  0.0292, -0.7047,
          0.1495, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459,  0.3367, -0.8891,  0.3681, -0.4621, -0.2508,
          0.3866],
        [-0.5199, -1.4598,  1.4809, -0.5296, -1.4100,  2.5280,  0.5804, -0.9284,
          0.9980, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459,  0.3631, -0.4555,  0.3681, -0.4621, -0.2496,
          0.4541],
        [-0.1981,  1.0633,  0.9373, -1.5942,  0.1827, -0.7031,  0.0292, -0.7047,
          0.1495, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459,  0.3631, -0.4555,  0.5872, -0.6955, -0.2496,
          0.4541],
        [-0.5199, -1.4598,  1.4809, -0.5296, -1.4100,  2.5280,  0.5804, -0.9284,
          0.9980, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459,  0.5781, -0.6856,  0.5641, -0.5429, -0.2483,
          0.5215],
        [-0.1981,  1.0633,  0.9373, -1.5942,  0.1827, -0.7031,  0.0292, -0.7047,
          0.1495, -0.7382,  0.5828,  0.6865, -0.5352, -0.3123, -1.2477, -1.6916,
         -2.0771,  0.9703, -0.6094,  1.4018, -0.1036,  0.5364, -1.7615, -1.5067,
         -0.5230,  0.5667, -1.6076, -0.5847, -0.4096, -1.3761,  0.6366,  0.2417,
         -0.3364, -1.6510, -0.0459,  0.5555, -0.5352,  0.2259,  0.4805, -0.2447,
          0.7239]], device=&#39;cuda:0&#39;, grad_fn=&lt;SelectBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice how the dimension with all zeros (the default padding index) are also filled in with all zeros in the resulting tensor.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Full-Architecture">Full Architecture<a class="anchor-link" href="#Full-Architecture"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we are ready to plug in the embedding to any <code>tsai</code> learner. Our architecture is fairly straightforward:</p>
<ul>
<li><code>head</code> is the head of the network and runs the data through the <code>multiEmbedding</code> layer</li>
<li><code>body</code> takes the output of <code>head</code> and run it through the desired architecture selected by the user in <code>ts_arch</code></li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="footSeqModel" class="doc_header"><code>class</code> <code>footSeqModel</code><a href="https://github.com/tkharrat/footSeq/tree/master/footSeq/model/learner.py#L115" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>footSeqModel</code>(<strong><code>ts_arch</code></strong>:<code>Module</code>, <strong><code>n_cont</code></strong>:<code>int</code>, <strong><code>c_out</code></strong>:<code>int</code>, <strong><code>ts_kwargs</code></strong>, <strong><code>embed_dims</code></strong>:<code>List</code>[<code>int</code>]=<em><code>None</code></em>, <strong><code>std</code></strong>:<code>float</code>=<em><code>0.01</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Sequence model with an embedding head.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.models.RNN</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">n_cont</span> <span class="o">=</span> <span class="n">padded_batch</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ts_model</span> <span class="o">=</span> <span class="n">LSTM</span>
<span class="n">ts_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_layers&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;bidirectional&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">footSeqModel</span><span class="p">(</span><span class="n">ts_arch</span><span class="o">=</span><span class="n">ts_model</span><span class="p">,</span> <span class="n">n_cont</span><span class="o">=</span><span class="n">n_cont</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ts_kwargs</span><span class="o">=</span><span class="n">ts_args</span><span class="p">,</span> <span class="n">n_embeds</span><span class="o">=</span><span class="n">n_embeds</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>footSeqModel(
  (head): MultiEmbedding(
    (cat_embed): ModuleList(
      (0): Embedding(22, 9)
      (1): Embedding(4, 3)
      (2): Embedding(10, 6)
      (3): Embedding(3, 3)
      (4): Embedding(3, 3)
      (5): Embedding(3, 3)
      (6): Embedding(3, 3)
      (7): Embedding(7, 5)
    )
  )
  (body): LSTM(
    (rnn): LSTM(41, 100, num_layers=2, batch_first=True, bidirectional=True)
    (fc): Linear(in_features=200, out_features=2, bias=True)
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="p">(</span><span class="n">padded_batch</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">padded_batch</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 0.0375,  0.0235],
        [-0.0329,  0.0624],
        [ 0.0071,  0.0449],
        [ 0.0592,  0.0041],
        [-0.0337,  0.0609]], device=&#39;cuda:0&#39;, grad_fn=&lt;AddmmBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Learner">Learner<a class="anchor-link" href="#Learner"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Defining a learner at this stage is straightforward, we just need to decide on the appropriate loss function to use, pass the <code>dataloaders</code> and the metrics we want to track:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.metrics</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">srtd_dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">])</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(valley=0.002511886414140463)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='0' class='' max='2' style='width:300px; height:20px; vertical-align: middle;'></progress>
      0.00% [0/2 00:00<00:00]
    </div>
    
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table><p>

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='2167' class='' max='91592' style='width:300px; height:20px; vertical-align: middle;'></progress>
      2.37% [2167/91592 00:27<18:57 0.0459]
    </div>
    
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

